---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

const areaSlug = 'digital-health-transformation';
const areaName = 'Digital Health Transformation';
const areaDescription = 'Examining telemedicine, health information systems, collective intelligence, and the digitization of healthcare delivery.';

// Get research projects in this category
const allResearch = await getCollection('research');
const projects = allResearch.filter(r => r.data.category === areaSlug);
const activeProjects = projects.filter(p => p.data.status === 'active');
const completedProjects = projects.filter(p => p.data.status === 'completed');

// Get related publications
const allPublications = await getCollection('publications');
const relatedPublications = allPublications.filter(pub => {
  const text = `${pub.data.title} ${pub.data.abstract || ''}`.toLowerCase();
  return text.includes('digital') || text.includes('telemedicine') || text.includes('telehealth') ||
         text.includes('information') || text.includes('mobile health') || text.includes('mhealth') ||
         text.includes('collective') || text.includes('data') || text.includes('community');
}).slice(0, 8);
---

<BaseLayout title={areaName} description={areaDescription}>

  <!-- Hero -->
  <section class="relative py-20 bg-cover bg-center" style="background-image: linear-gradient(135deg, rgba(255, 255, 255, 0.88) 0%, rgba(245, 244, 240, 0.85) 100%), url('/images/research/digital-health-policy-icon.jpg');">
    <div class="container">
      <a href="/research" class="text-carolina hover:text-carolina-dark transition-colors text-sm font-medium flex items-center gap-2 mb-6">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
        </svg>
        All Research
      </a>
      <p class="eyebrow text-carolina mb-4">Research Area</p>
      <h1 class="text-4xl md:text-5xl font-display text-navy mb-6">{areaName}</h1>
      <p class="text-xl text-charcoal max-w-3xl">
        {areaDescription}
      </p>
    </div>
  </section>

  <!-- Overview -->
  <section class="py-12 bg-cream">
    <div class="container">
      <div class="max-w-3xl">
        <h2 class="text-2xl font-display text-navy mb-4">Overview</h2>
        <div class="prose prose-slate">
          <p>
            The digital transformation of healthcare creates both opportunities and challenges. Our research examines
            how digital technologies—from telemedicine to health information systems to collective intelligence
            platforms—can improve health outcomes, particularly in underserved communities.
          </p>
          <p>
            Key areas of investigation include:
          </p>
          <ul>
            <li><strong>Telemedicine & virtual care:</strong> Evaluating the effectiveness, equity, and optimal implementation of telehealth services</li>
            <li><strong>Health information systems:</strong> Studying how data flows, EHR design, and interoperability affect care quality</li>
            <li><strong>Collective intelligence:</strong> Exploring how aggregating clinical judgment can improve diagnostic accuracy</li>
            <li><strong>Digital health equity:</strong> Ensuring digital health innovations benefit all populations, including those with limited digital access</li>
            <li><strong>Community health digitization:</strong> Supporting community-based organizations in adopting digital health tools</li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <!-- Active Projects -->
  {activeProjects.length > 0 && (
    <section class="py-16 bg-paper">
      <div class="container">
        <h2 class="text-2xl font-display text-navy mb-8">Active Projects</h2>
        <div class="grid md:grid-cols-2 gap-6">
          {activeProjects.map((project) => (
            <a href={`/research/${project.id}`} class="card group">
              <div class="flex items-center gap-2 mb-3">
                <span class="text-xs px-2 py-0.5 rounded bg-green-100 text-green-700">Active</span>
                {project.data.featured && (
                  <span class="text-xs px-2 py-0.5 rounded bg-carolina-pale text-carolina-dark">Featured</span>
                )}
              </div>
              <h3 class="text-lg font-semibold text-navy group-hover:text-carolina transition-colors mb-2">
                {project.data.title}
              </h3>
              <p class="text-sm text-slate leading-relaxed mb-4">
                {project.data.description}
              </p>
              {project.data.fundingSources && project.data.fundingSources.length > 0 && (
                <div class="text-xs text-slate">
                  <span class="font-medium">Funding:</span> {project.data.fundingSources.join(', ')}
                </div>
              )}
              {project.data.collaborators && project.data.collaborators.length > 0 && (
                <div class="text-xs text-slate mt-1">
                  <span class="font-medium">Partners:</span> {project.data.collaborators.join(', ')}
                </div>
              )}
              <div class="mt-4 text-carolina text-sm font-medium flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity">
                View project
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
                </svg>
              </div>
            </a>
          ))}
        </div>
      </div>
    </section>
  )}

  <!-- Completed Projects -->
  {completedProjects.length > 0 && (
    <section class="py-16 bg-stone/30">
      <div class="container">
        <h2 class="text-2xl font-display text-navy mb-8">Completed Projects</h2>
        <div class="grid md:grid-cols-3 gap-6">
          {completedProjects.map((project) => (
            <a href={`/research/${project.id}`} class="card bg-white group">
              <span class="text-xs px-2 py-0.5 rounded bg-slate/10 text-slate mb-3 inline-block">Completed</span>
              <h3 class="font-semibold text-navy group-hover:text-carolina transition-colors mb-2">
                {project.data.title}
              </h3>
              <p class="text-sm text-slate line-clamp-2">
                {project.data.description}
              </p>
            </a>
          ))}
        </div>
      </div>
    </section>
  )}

  <!-- Related Publications -->
  {relatedPublications.length > 0 && (
    <section class="py-16 bg-paper">
      <div class="container">
        <div class="flex items-end justify-between mb-8">
          <h2 class="text-2xl font-display text-navy">Related Publications</h2>
          <a href="/publications" class="text-carolina font-medium text-sm flex items-center gap-2 hover:text-carolina-dark transition-colors">
            View all publications
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
            </svg>
          </a>
        </div>
        <div class="space-y-4">
          {relatedPublications.map((pub) => (
            <div class="card">
              <h4 class="font-semibold text-navy mb-1">{pub.data.title}</h4>
              <p class="text-sm text-slate mb-2">
                {pub.data.authors.join(', ')} ({pub.data.year})
              </p>
              <p class="text-sm text-carolina">{pub.data.journal}</p>
              {pub.data.doi && (
                <a href={`https://doi.org/${pub.data.doi}`} target="_blank" rel="noopener noreferrer" class="text-xs text-carolina-dark hover:underline mt-2 inline-block">
                  DOI: {pub.data.doi}
                </a>
              )}
            </div>
          ))}
        </div>
      </div>
    </section>
  )}

  <!-- Tools & Platforms -->
  <section class="py-16 bg-cream">
    <div class="container">
      <h2 class="text-2xl font-display text-navy mb-8">Tools & Platforms</h2>
      <div class="grid md:grid-cols-2 gap-6">
        <a href="/tools" class="card group">
          <h3 class="text-lg font-semibold text-navy group-hover:text-carolina transition-colors mb-2">CareLoom (Healthy Future)</h3>
          <p class="text-sm text-slate">
            Open-source platform for community health workers delivering maternal and child health
            home visiting programs, with AI-enhanced content recommendations.
          </p>
        </a>
        <a href="/tools" class="card group">
          <h3 class="text-lg font-semibold text-navy group-hover:text-carolina transition-colors mb-2">Sentinel Information Markets</h3>
          <p class="text-sm text-slate">
            Information market-based participatory surveillance platform for public health
            monitoring, enabling community-driven early warning systems for disease outbreaks in LMICs.
          </p>
        </a>
      </div>
    </div>
  </section>

  <!-- Community Partners -->
  <section class="py-16 bg-paper">
    <div class="container">
      <h2 class="text-2xl font-display text-navy mb-8">Community Partners</h2>
      <p class="text-slate mb-6 max-w-2xl">
        Our digital health transformation research is grounded in partnerships with community organizations
        working to improve health in underserved populations.
      </p>
      <div class="flex flex-wrap gap-4">
        <a href="https://elcentronc.org" target="_blank" rel="noopener noreferrer" class="px-4 py-2 bg-cream rounded-lg text-navy hover:text-carolina transition-colors text-sm font-medium">
          El Centro Hispano
        </a>
        <a href="https://cfkafrica.org" target="_blank" rel="noopener noreferrer" class="px-4 py-2 bg-cream rounded-lg text-navy hover:text-carolina transition-colors text-sm font-medium">
          CFK Africa
        </a>
        <a href="https://ncdhit.org" target="_blank" rel="noopener noreferrer" class="px-4 py-2 bg-cream rounded-lg text-navy hover:text-carolina transition-colors text-sm font-medium">
          NC DHIT
        </a>
      </div>
    </div>
  </section>

  <!-- CTA -->
  <section class="py-16 bg-carolina-pale">
    <div class="container text-center">
      <h2 class="text-2xl font-display text-navy mb-4">Partner With Us</h2>
      <p class="text-slate mb-6 max-w-xl mx-auto">
        We work with community organizations, health systems, and technology partners
        to advance digital health innovation that benefits all communities.
      </p>
      <div class="flex justify-center gap-4">
        <a href="/contact" class="btn-primary">Get in Touch</a>
        <a href="/services/behavioral-insights" class="btn-secondary">Behavioral Insights Services</a>
      </div>
    </div>
  </section>

</BaseLayout>
